-- CREATE DATABASE

CREATE DATABASE INVENTORY;

-- SEE DATABASES

SHOW DATABASES;

-- USE DATABASE 

USE INVENTORY;

-- CREATE TABLE 

CREATE TABLE SUPPLIER

(SID CHAR(5) NOT NULL PRIMARY KEY,

SNAME VARCHAR(25) NOT NULL,

SADDR VARCHAR(40) ,

SCITY VARCHAR(20),

SPHONE CHAR(10),

SEMAIL VARCHAR(40));

-- DESCRIBE TABLE 

DESC SUPPLIER;





CREATE TABLE PRODUCT (
PID CHAR(5) NOT NULL PRIMARY KEY,

PDESC VARCHAR(25) NOT NULL,

PRICE DECIMAL(10,2) NOT NULL, 

CATEGORY CHAR(2)  ,

SID CHAR(5) ,
CONSTRAINT SID FOREIGN KEY(SID) REFERENCES SUPPLIER(SID));
 
DESC PRODUCT;
SELECT * FROM PRODUCT;


show tables;




CREATE TABLE CUST (
CID CHAR(5) NOT NULL PRIMARY KEY,

CNAME VARCHAR(25) NOT NULL,

CADDR VARCHAR(40) NOT NULL, 

CCITY VARCHAR(20) NOT NULL, 

CPHONE CHAR(10) NOT NULL, 

CEMAIL VARCHAR(25) NOT NULL, 

CDOB DATE);

SELECT * FROM CUST;
desc cust;




CREATE TABLE ORDERS(
OID CHAR(5) NOT NULL,

ODATE DATE,

CID CHAR(5) ,

PID CHAR(5),
	CONSTRAINT FOREIGN KEY (PID) references PRODUCT(PID),
OQTY DECIMAL(10,2));

SELECT * FROM ORDERS;
DESC ORDERS;


SHOW TABLES;



-- SUPPLIER;

INSERT INTO SUPPLIER (SID, SNAME, SADDR, SCITY, SPHONE, SEMAIL) VALUES
('S0001', 'HP WORLD', 'SECTOR 11 DWARKA', 'DELHI', '9999001001', 'HPWORLD@GMAIL.COM'),
('S0002', 'MEDCARE', 'SC KANPUR, NP ROAD', 'DEHERADHUN', '8887001222', 'MEDCARE@GMAIL.COM'),
('S0003', 'RETAIL SHOPPERS', 'B1/45, JANAKPURI', 'DELHI', '3337001333', 'RETAILSHOP@YAHOO.COM.IN'),
('S0004', 'IT PICKUP', 'DLF, PHASE 5', 'GURGAON', '703331343', 'ITPICKUP@GMAIL.COM'),
('S0005', 'HOME FINISHER', 'C2-431, SUPERTECH', 'NAGPUR', '99003388', 'HOMEFINISH@OUTLOOK.COM'),
('S0006','AMPEX ELECTRONICS','N13 SHIVAJI NAGAR','MUMBAI',9876487222,'AMPEXELECTRONICS@GMAIL.COM'),
('S0007','TECHNOCIRCUITRY','SC  ST- ROAD','HYDERABAD',8346527233,'TECHNOCIRCUITRY@GMAIL.COM'),
('S0008','BRIGHT CURRENTS','SECTOR B/16 DWARKA','DELHI',9734872342,'BRIGHTCURRENTS@GMAIL.COM'),
('S0009','RESISTOR LABS','DLF  PHASE 5','GURGAON',9678745834,'RESISTORLABS@GMAIL.COM'),
('S0010','CIRCUITSAVVY SOLUTIONS','SECTOR 15 DWARKA','DELHI',9367528321,'CIRCUITSAVVYSOLUTIONS@GMAIL.COM'),
('S0011','INNOVOLT INC.','C2/16  SUPERELEC','MUMBAI',8536423223,'INNOVOLTINC.@YAHOO.COM.IN'),
('S0012','CONNECTCIRCUIT SOLUTIONS','SZ  ST- ROAD','HYDERABAD',8753462352,'CONNECTCIRCUITSOLUTIONS@YAHOO.COM.IN'),
('S0013','DIGICIRCUIT CREATORS','N2 NEELAM NAGAR','MUMBAI',9638752634,'DIGICIRCUITCREATORS@YAHOO.COM.IN'),
('S0014','WIRE WORLD','ACR JUBILEE HILLS','HYDERABAD',8365262434,'WIREWORLD@YAHOO.COM.IN'),
('S0015','SMARTGRID GADGETS','C2-444 SUPERTECH','NAGPUR',9638752625,'SMARTGRIDGADGETS@YAHOO.COM.IN'),
('S0016','ELEKTRON EDGE','A12 GODREJ','MUMBAI',8352627363,'ELEKTRONEDGE@OUTLOOK.COM'),
('S0017','ELECTROFLOW','SECTOR A/16 DWARKA','DELHI',9037462728,'ELECTROFLOW@OUTLOOK.COM'),
('S0018','TECHNOCURRENTS','SDL  PHASE 1','GURGAON',8008036536,'TECHNOCURRENTS@GMAIL.COM'),
('S0019','DELL TECHNOLOGIES','C2  HAZELNUT','NAGPUR',9346536200,'DELLTECHNOLOGIES@GMAIL.COM'),
('S0020','HOME CENTER','SECTOR 3  PHASE 5','GURGAON',9356427320,'HOMECENTER@GMAIL.COM');

SELECT * FROM SUPPLIER;
-- product

INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID)

VALUES ('P0001', 'HP LAPTOP AND CHARGER', 6000, 'IT', 'S0001'),
('P0002', 'MIXER GRINDER', 10000, 'HA', 'S0005'),
('P0003', 'MOBILE PHONE', 4000, 'IT', 'S0004'),
('P0004', 'STEAMER', 400, 'HC', 'S0002'),
('P0005', 'HANGING LIGHTS', 5000, 'HA', 'S0003'),
('P0006', 'HARD DISK 500GB', 15000, 'IT', 'S0004'),
('P0007', 'CHAIRS AND TABLES', 10500, 'HA', 'S0003'),
('P0008', 'HARD DISK 500GB', 15000, 'HA', 'S0003'),
('P0009', 'HARD DISK 1000GB', 30000, 'HA', 'S0003'),
('P0010','CABLE WIRES',10000,'HA','S0010'),
('P0011','DELL LAPTOP AND CHARGER',25000,'IT','S0019'),
('P0012','STUDY & TABLE LAMPS',15000,'HA','S0020'),
('P0013','BLUETOOTH MOUSE',18000,'IT','S0009'),
('P0014','BLACKBERRY MOBILES',10000,'IT','S0017'),
('P0015','BLUETOOTH KEYBOARD',9000,'IT','S0018'),
('P0016','FAIRY LIGHTS',5000,'HA','S0008'),
('P0017','WIFI ROUTER & CABLE',13000,'HA','S0012'),
('P0018','SET TOP BOX',12000,'HA','S0013'),
('P0019','COMPUTERS',24000,'IT','S0014'),
('P0020','LED BULBS TUBELIGHTS',4500,'HA','S0007'),
('P0021','GAS STOVE',6500,'HA','S0015'),
('P0022','BLUETOOTH SPEAKER',4500,'IT','S0004'),
('P0023','WIRELESS HEADPHONES',3000,'IT','S0004'),
('P0024','AIR  COOLER',11500,'HA','S0015'),
('P0025','PENDRIVE 132GB',800,'IT','S0004'),
('P0026','WASHING MACHINE',21000,'HA','S0015');

SELECT * FROM PRODUCT;

INSERT INTO CUST (CID,CNAME,CADDR,CCITY,CPHONE,CEMAIL,CDOB) VALUES
('C0001',' ABHISHEK SHARMA','7TH CROSS. JANAKPURI','DELHI','9088801001',' ASHARMA@GMAIL.COM','1996-01-10'),
('C0002',' RINKU SHARMA','HNO-8205','NOIDA','8098810775',' RINKU@GMAIL.COM','1999-04-19'),
('C0003',' TEENA MATHEW','DLF PHASE 5','GURGAON','9880601077',' TEENA@YAHOO.COM','1990-06-29'),
('C0004',' ROSHAN SINGH','FLAT NO.6A  RAJDUR ROAD','DEHERADHUN','8767601123',' ROSHAN@OUTLOOK.COM','1996-08-20'),
('C0005',' MONIKA BABI','POCKET 2  SECTOR 11','DELHI','9577640107',' MONIKA@GMAIL.COM','1997-07-20'),
('C0006','SURAJ SHARMA','FLAT NO.10B  RAJDUR ROAD','DEHERADHUN','9873972647','SURAJ@GMAIL.COM','1991-12-04'),
('C0007','AKSHAY SINGH','POCKET 5  SECTOR 10','DELHI','9374872678','AKSHAY@GMAIL.COM','1998-06-02'),
('C0008','SANVI KUMAR','CENTERPOINT  B WING/203','GURGAON','8364824282','SANVI@GMAIL.COM','1994-03-25'),
('C0009','PRANAY PATEL','R57 CITY OF JOY','NAGPUR','8534622734','PRANAY@GMAIL.COM','1980-06-02'),
('C0010','ANJALI GADA','FLAT NO.107/SL-9  SARDAR ROAD','MUMBAI','9753657103','ANJALI@GMAIL.COM','1981-03-17'),
('C0011','PRIYANKA SHUKLA','SUNRISE COLONY 140A','HYDERABAD','9365620000','PRIYANKA@OUTLOOK.COM','1990-10-21'),
('C0012','SANJANA GUPTA','POCKET 1  SECTOR 8','DELHI','9375825863','SANJANA@OUTLOOK.COM','1974-04-19'),
('C0013','ATHARVA SHARMA','HAZELNUT 506/B','MUMBAI','9635624600','ATHARVA@OUTLOOK.COM','1977-07-17'),
('C0014','SHRUTI SINGH','POCKET 3  SUNSHINE ROAD','DELHI','9767246300','SHRUTI@OUTLOOK.COM','1947-07-15'),
('C0015','SHALINI SHETTY','FLAT NO.10B  RAJDUR ROAD','MUMBAI','8632736003','SHALINI@OUTLOOK.COM','1986-11-11'),
('C0016','AARYA SHETTY','HORIZON POINT  B WING/507','HYDERABAD','8263642000','AARYA@GMAIL.COM','1992-08-08'),
('C0017','PRISHA SHINDE','C332 PALACE JOY','MUMBAI','9065656732','PRISHA@GMAIL.COM','1996-07-22'),
('C0018','ANITA SHARMA','FLAT NO.107/B  BP ROAD','NOIDA','9723600093','ANITA@GMAIL.COM','1993-05-11'),
('C0019','SOHAM SINGH','FLAT NO.10B A WING RAJBAUG ROAD','NAGPUR','9637200121','SOHAM@YAHOO.COM','1998-07-20'),
('C0020','PRITI KUMAR','FLAT NO.10B  RJ ROAD','DEHERADHUN','9767417200','PRITI@YAHOO.COM','1993-04-23'),
('C0021','SHAILAJA PATEL','SUNSHINE COLONY A12','DELHI','9236579888','SHAILAJA@YAHOO.COM','1990-05-01'),
('C0022','KARTIKA KUMAR','A123 CITY OF WONDER','MUMBAI','9653271223','KARTIKA@YAHOO.COM','1987-12-21'),
('C0023','AJAY SHUKLA','LODHA GRP 10/1088','NAGPUR','8763242799','AJAY@YAHOO.COM','1988-01-01'),
('C0024','ISHA GUPTA','AKRUTI ELEGANCE  B WING/203','MUMBAI','8764362342','ISHA@GMAIL.COM','1988-07-01');

SELECT * FROM ORDERS;

INSERT INTO ORDERS (OID, ODATE, CID, PID, OQTY) 
values ('O0001', '2018-07-15', 'C0005', 'P0011',1),
('O0002', '2016-12-28', 'C0002', 'P0009', 4),
('O0003', '2017-01-07', 'C0001', 'P0001', 2),
('O0004', '2017-02-05', 'C0014', 'P0007',7),
('O0005', '2017-02-10', 'C0013', 'P0003',2),
('O0006', '2017-03-28', 'C0008', 'P0023',3),
('O0007', '2017-03-26', 'C0009', 'P0015',2),
('O0008', '2017-04-09', 'C0010', 'P0016',1),
('O0009', '2017-08-07', 'C0020', 'P0006',2),
('O0010', '2017-09-22', 'C0011', 'P0013',1),
('O0011', '2017-10-31', 'C0016', 'P0014',3),
('O0012', '2017-11-30', 'C0006', 'P0022',2),
('O0013', '2017-11-29', 'C0004', 'P0005',2),
('O0014', '2018-01-19', 'C0007', 'P0002',1),
('O0015', '2018-03-08', 'C0002', 'P0026',2),
('O0016', '2018-04-03', 'C0001', 'P0008',3),
('O0017', '2018-04-11', 'C0002', 'P0003',6),
('O0018', '2018-06-23', 'C0002', 'P0003',1),
('O0019', '2018-08-06', 'C0019', 'P0019',4),
('O0020', '2018-03-10', 'C0017', 'P0018',2),
('O0021', '2018-03-10', 'C0024', 'P0010',2),
('O0022', '2018-03-10', 'C0015', 'P0008',1);




-- 1. ASSIGN PRIMARY KEY AFTER CREATING THE TABLE

ALTER TABLE ORDERS ADD constraint primary key(OID);


-- 2. ASSIGN FOREIGN KEY AFTER CREATING THE TABLE

ALTER TABLE ORDERS ADD CONSTRAINT FOREIGN KEY (CID) references CUST(CID);

-- 3. ALTER THE COLUMN CONSTRAINT AND DATA TYPE AFTER THE TABLE IS MADE

ALTER TABLE SUPPLIER MODIFY SADDR varchar(25) NOT NULL;

ALTER TABLE SUPPLIER MODIFY SCITY varchar(25) NOT NULL;

ALTER TABLE SUPPLIER MODIFY SPHONE char(10) NOT NULL UNIQUE;

ALTER TABLE SUPPLIER MODIFY SEMAIL varchar(45) NOT NULL;

ALTER TABLE PRODUCT ADD CONSTRAINT PRICE CHECK(PRICE >= 0 );

ALTER TABLE PRODUCT ADD CONSTRAINT CHECK(CATEGORY IN ('IT','HA','HC'));

ALTER TABLE CUST ADD CONSTRAINT CDOB CHECK(CDOB < '2000-01-01');

ALTER TABLE ORDERS ADD CONSTRAINT OQTY CHECK(OQTY>=1);


-- 4. ADD COLUMN ORDER_DESC IN ORDERS TABLE

ALTER TABLE ORDERS ADD ORDER_DESC VARCHAR(50);

-- 5. DELETE COLUMN ORDER_DESC IN ORDERS TABLE

ALTER TABLE ORDERS drop ORDER_DESC;

-- 6. RENAME CUST TABLE TO CUSTOMER 
 
RENAME TABLE CUST TO CUSTOMER; 

-- 7. RENAME CUSTOMER TABLE TO CUST
 
ALTER TABLE CUSTOMER RENAME CUST;

-- 8. RENAME THE CPHONE COLUMN TO CONTACT

ALTER TABLE CUST CHANGE CPHONE CONTACT CHAR(10);

-- 9. MODIFY THE PDESC LENGTH TO 30

ALTER TABLE PRODUCT MODIFY PDESC VARCHAR(30);

-- 10. update the category hc to "HA" where price is less than 10000.

UPDATE PRODUCT SET CATEGORY="HC" WHERE CATEGORY="HA" AND PRICE<10000;
SELECT * FROM PRODUCT;

-- 11. update PDESC to hard disk 250gb where pid is P0006.

UPDATE PRODUCT SET PDESC="HARD DISK 250GB" WHERE PID="P0006";

-- 12. SHOW ALL RECORDS FROM PRODUCT

SELECT * FROM PRODUCT;


-- 13.FIRST 5 RECORDS FROM ORDERS -----------


SELECT * FROM ORDERS LIMIT 5;


-- 14. LAST 5 RECORDS-------

SELECT * FROM ORDERS ORDER BY OID DESC LIMIT 5  ;



-- 15. show the ORDERID,PRODUCTID AND QUANTITY from the ORDERS table sorted by QUATITY ORDERED.

select OID,PID,OQTY from ORDERS order by OQTY;


-- 16. Shows ALL details from the supplier table sorted by email.

select * from supplier order by semail;

-- 17. Shows all the CustomerID and customer name in lowercase letter and renamed as cid and cust_name from the customers table.

SELECT CID as cid,LOWER(CNAME) AS cust_name FROM Cust;

-- 18. show the name , city ,  phone number , email from the suppliers table sorted by the City in descending order then by phone number in ascending order.

select sname, scity, sPhone, semail from Supplier order by scity desc , sphone asc;


-- 19. show the supplier name and customer name from ‘mumbai' only.

SELECT DISTINCT(C.CNAME),C.CID,C.CCITY,S.SNAME,S.SID 
FROM
CUST AS C
JOIN
ORDERS AS O 
ON
O.CID=C.CID
join
PRODUCT AS P
ON 
O.PID=P.PID
join
SUPPLIER AS S
ON 
P.SID=S.SID
WHERE
C.CCITY="mumbai"
AND 
S.SCITY="mumbai";


-- 20. Showing ALL information of customers that are born after 1994 and are from delhi

SELECT * FROM CUST WHERE CDOB>"1994-12-31" AND CCITY="DELHI";

--  21. Shows ALL the data of  from suppliers starting with name with A or B.

SELECT * FROM SUPPLIER WHERE SNAME LIKE "A%" OR SNAME LIKE "B%";

-- 22. Shows ALL the data of  from suppliers HAVING "ele" in there name.

SELECT * FROM SUPPLIER
WHERE 
SNAME LIKE '%ELE%';

-- 23. Shows ALL the data of  from suppliers HAVING second letter is e in there name.

SELECT * FROM SUPPLIER
WHERE 
SNAME LIKE '_e%';

-- 24. Shows ALL types of hard_disk .

SELECT * FROM PRODUCT WHERE PDESC LIKE "HARD_DISK%";

-- 25 . show all the orders details of year 2017 AND 3 rd month .

select * from orders where YEAR (ODATE)=2017 and month(odate)=3; 


-- 26.Shows the products grouped by category having price greater than 10000; 

select * from product  where price >10000 order by category ;

-- 27 .NO. OF PRODUCT OF EACH CATEGORY ----------

SELECT COUNT(PID) AS NO_OF_PRODUCT,CATEGORY FROM PRODUCT GROUP BY CATEGORY;

-- 28. customers who have age greater than 30 

SELECT cname ,(YEAR(now())-YEAR(CDOB)) as age FROM CUST where (YEAR(now())-YEAR(CDOB))>30;

-- 29. show the most expensive product and its price

SELECT PDESC,PRICE FROM PRODUCT
WHERE PRICE =(SELECT MAX(PRICE) FROM PRODUCT);

-- 30. show the cheapest product and its price

SELECT PDESC,PRICE FROM PRODUCT
WHERE PRICE =(SELECT Min(PRICE) FROM PRODUCT);

-- 31. create view named product order and display the order id ,product desc , orderdate , price , customer name , from which city to  deleiver an to which city and the address of the customer

CREATE VIEW PRODUCT_ORDER AS
    SELECT 
        OID,
        P.PDESC,
        O.ODATE,
        P.PRICE,
        C.CNAME,
        CONCAT(S.SCITY, ' ', 'TO', ' ', C.CCITY) AS DELIVER_TO,
        C.CADDR AS ADDRESS
    FROM
        ORDERS AS O
            LEFT JOIN
        PRODUCT AS P ON P.PID = O.PID
            JOIN
        SUPPLIER AS S ON S.SID = P.SID
            JOIN
        CUST AS C ON C.CID = O.CID;
        
        
SELECT* FROM PRODUCT_ORDER;

-- 32. create view named customer order and display the cust id ,cust name , delivery address , order id, product id and order date;


create view customer_order as
select c.cid as cust_id,c.cname as cust_name ,c.caddr delivery_address ,o.oid as order_id,o.pid as product_id,o.odate as order_date 
from
orders as o join 
cust as c
on 
o.cid=c.cid;
 select * from customer_order;

-- 33. show the product and category where product price is less than avg price of product;

select pdesc , category from product where price < (select avg(price) from product) order by category;




-- 34. Find avg price AND total price of the order placed

SELECT avg((o.oqty)*(p.price)) as average_price, sum((o.oqty)*(p.price)) as total_price
FROM
PRODUCT AS P
JOIN
ORDERS AS O 
ON
P.PID=O.PID;

-- 35. Round ofF the avg price AND total price of the order placed

SELECT ROUND(avg((o.oqty)*(p.price))) as average_price, ROUND(sum((o.oqty)*(p.price))) as total_price
FROM
PRODUCT AS P
JOIN
ORDERS AS O 
ON
P.PID=O.PID;


-- 36. fetch the last 2 character of customer id from the cust table and rename as ShortId.
SELECT SUBSTRING(cid, 4, 5) AS ShortId FROM Cust;

SELECT right(Cid, 2) AS ShortId FROM Cust;

-- 37. MOST POPULAR PRODUCT --------------

SELECT 
    P.PDESC  AS MOST_POPULAR_PRODUCT
FROM
    PRODUCT AS P
        JOIN
    ORDERS AS O ON O.PID = P.PID
GROUP BY P.PID
ORDER BY SUM(O.OQTY) DESC
LIMIT 1
;

-- 38. LEAST ORDERED  ------------------------------
SELECT 
    P.PDESC AS MOST_POPULAR_PRODUCT
FROM
    PRODUCT AS P
        JOIN
    ORDERS AS O ON O.PID = P.PID
GROUP BY P.PID
ORDER BY SUM(O.OQTY) 
LIMIT 1
;

-- 39.PRODUCT THAT WHERE NEVER ORDERED -----------
-- 1 )
SELECT DISTINCT(PDESC),PID 
FROM
PRODUCT WHERE PID NOT IN (
SELECT DISTINCT P.PID 
FROM
PRODUCT AS P
JOIN
ORDERS AS O 
ON
P.PID=O.PID);

-- 2)

select PDESC,PID  from product where not exists(
select * from orders where product.pid=orders.pid);


-- 40. SHOW DATA OF THE PRODUCT AND SUPPLIER WHERE NAME OF SUPPLIER AND PRODUCT BOTH START WITH "C".

SELECT S.SID,SNAME, P.PID ,P.PDESC FROM
SUPPLIER AS S
JOIN
PRODUCT AS P
ON
P.SID=S.SID
WHERE
S.SNAME LIKE "C%" AND PDESC LIKE "C%"
;

select PID ,oqty,
case 
     when oqty>=2 then "the order quantity is greater than or equal to 2"
    when oqty=1 then "the order quantity is equal TO 1"
    else "THE PRODUCT WAS NOT ORDERED"
end as result
from orders;


-- DROP database INVENTORY;
